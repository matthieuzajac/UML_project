@startuml state diagram
header Diagramme d'États - Classe Novel
skinparam monochrome true
skinparam shadowing false

[*] --> Draft : createNovel()

state Draft {
  Draft : description = "Invisible pour les lecteurs"
  Draft : Le contenu peut être modifié librement
}

state Published {
  state Active {
    Active : Le roman apparaît dans les recherches
    Active : Les lecteurs reçoivent des notifications
  }
  
  state Hiatus {
    Hiatus : "En pause"
    Hiatus : Toujours visible mais marqué comme inactif
  }
  
  state Completed {
    Completed : "Terminé"
    Completed : Statut final pour les archives
  }
}

state Shadowbanned {
  Shadowbanned : Masqué des recherches publiques
  Shadowbanned : Accessible uniquement par lien direct
  Shadowbanned : En attente de révision modérateur
}

state Deleted {
  Deleted : Supprimé définitivement
  Deleted : Données archivées ou purgées
}

Draft --> Draft : updateMetadata()
Draft --> Active : publishFirstChapter()
Active --> Active : publishChapter()
Active --> Active : updateMetadata()
Hiatus --> Hiatus : updateMetadata()
Completed --> Completed : updateMetadata()

Active --> Hiatus : markAsHiatus() [si > 1 mois sans maj]
Hiatus --> Active : resumePublication()
Hiatus --> Completed : markAsCompleted()
Active --> Completed : markAsCompleted()
Completed --> Active : addSideStory()

Active --> Shadowbanned : moderatorAction() [violation des règles]
Hiatus --> Shadowbanned : moderatorAction() [violation des règles]
Completed --> Shadowbanned : moderatorAction() [violation des règles]
Shadowbanned --> Active : moderatorReview() [restaure actif]
Shadowbanned --> Hiatus : moderatorReview() [restaure hiatus]
Shadowbanned --> Completed : moderatorReview() [restaure terminé]
Shadowbanned --> Deleted : moderatorAction() [violation grave]

Draft --> Deleted : deleteByAuthor()
Published --> Deleted : deleteByAuthor()
Published --> Deleted : deleteByModerator()
Deleted --> [*]

@enduml