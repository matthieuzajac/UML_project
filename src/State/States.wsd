@startuml state diagram
header Diagramme d'États - Classe Novel
skinparam monochrome true
skinparam shadowing false
skinparam maxMessageSize 150

[*] --> Draft : createNovel()

state Draft {
  Draft : Invisible pour les lecteurs
  Draft : Contenu modifiable librement
}

state Published {
  state Active {
    Active : Roman visible dans les recherches
    Active : Notifications aux lecteurs
  }

  state Hiatus {
    Hiatus : "En pause"
    Hiatus : Visible mais inactif
  }

  state Completed {
    Completed : "Terminé"
    Completed : Statut final d'archive
  }
}

state Shadowbanned {
  Shadowbanned : Masqué des recherches publiques
  Shadowbanned : Accès par lien direct
  Shadowbanned : En attente de modération
}

state Deleted {
  Deleted : Supprimé définitivement
  Deleted : Données archivées/purgées
}

' Transitions internes
Draft --> Draft : updateMetadata()
Active --> Active : publishChapter()\nupdateMetadata()
Hiatus --> Hiatus : updateMetadata()
Completed --> Completed : updateMetadata()

' Transitions principales
Draft --> Active : publishFirstChapter()
Active --> Hiatus : markAsHiatus()\n[> 1 mois sans maj]
Hiatus --> Active : resumePublication()
Hiatus --> Completed : markAsCompleted()
Active --> Completed : markAsCompleted()
Completed --> Active : addSideStory()

' Actions de modération (regroupées)
Active --> Shadowbanned : moderatorAction()\n[violation]
Hiatus --> Shadowbanned : moderatorAction()\n[violation]
Completed --> Shadowbanned : moderatorAction()\n[violation]

' Restauration par modération
Shadowbanned -down-> Active : moderatorReview()\n[restaure]
Shadowbanned -left-> Hiatus : moderatorReview()\n[restaure]
Shadowbanned -up-> Completed : moderatorReview()\n[restaure]

' Suppression
Draft --> Deleted : deleteByAuthor()
Published --> Deleted : deleteByAuthor()\nor\nmoderator()
Shadowbanned --> Deleted : moderatorAction()\n[violation grave]
Deleted --> [*]

@enduml